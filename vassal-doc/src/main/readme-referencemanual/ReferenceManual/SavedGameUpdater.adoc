== VASSAL Reference Manual
[#top]

[.small]#<<index.adoc#toc,Home>> > <<Tools.adoc#top,Tools>> > *Refresh Predefined Setups*#

'''''

=== Refresh Counters
When you update the <<Prototypes.adoc#top,Prototypes>> in a module, those changes will affect any *future* games started using that module, but the changes will not--by default at least--affect pieces in any ongoing games that you load with the new version of the module. VASSAL saved games include the complete definition of each piece in order to maintain saved game compatibility with older versions of a module: so that replays and saves sent to you by someone with an earlier version of the module will continue to work in the same way they always did with the old version.

But particularly since the <<GameModule.adoc#PredefinedSetup, Predefined Setups>> for module scenarios are stored internally as saved games, it is often important to module designers to be able to update an existing game to use the latest prototypes. That way a module designer can often avoid re-doing complex setups simply because prototypes have been updated and improved.

Running the _Refresh Predefined Setups_ tool is equivalent to running the <<GameRefresher.adoc#top, Refresh Counters Tool>> on each of the predefined setups in a module.

To use the refresher on all the <<GameModule.adoc#PredefinedSetup, Predefined Setups>> in a module go to the _Editor's_ _Tools_ menu and select _Refresh Pre-Defined Setups_. You will be shown a dialog with several choices affecting the manner in which the operation is to be carried out.

Click the _Run_ button when you are ready to perform the refresh. _All_ Predefined Setups in the module will be updated, _which may take some time, especially for complex modules with many pre-defined setups._ The chat log will show output and statistics from the operation. Once the operation is finished, pieces in all pre-defined setups will have been updated to use the latest prototypes.

[width="100%",cols="^50%,50%a",]
|===
|image:images/SavedGameUpdater.png[]+
|

*Use counter names to identify unkown counters?:*::

The Game Refresher identifies the new definition of each piece to refresh based on an internal Game Piece Id. If the module is from a pre-Game Refresher version of Vassal, or if the original piece definition has been deleted, then the Refresher cannot identify which piece definition to use. Enabling this option requests the refresher to locate the new definition based on the Basice Name recorded in the definition. You can use Test Mode to see if this resolves the missing definition error messages, without affecting the module

*Use names to match modified Text Label traits?:*::

When refreshing a Piece, it attempts to match each trait within the Piece to a matching trait in the new definition. For Text Label traits, changing the text or other properties causes the Refresher to skip updating the text label trait. Enabling this option causes the Refresher to use a trait with the same Name to update the piece, even if the definition of the trait has changed.

*Use names to match modified Layer traits?:*::

This option enables the same processing for Layer traits, forcing a Layer trait to be updated from a Layer in the definition with the same name, even if the definition has been changed.

*Test Mode - Game will not be updated:*::

This option performs the refresh and prints any summary or error messages, but makes no change to the module. It is useful if you have errors about missing definitions and want to see the effect of using different Refresher options, without making any changes.

*Delete pieces without a map:*::

This option deletes any pieces defined in the Game that do not exist on any map. These pieces cannot be used in the game, so normally, you do want to delete these.

*Refresh Dynamic Property values with latest default values from module:*::

If the default value of a Dynamic Property trait has been changed, then this option sets whether that default value should be used to replace the existing value in the matching Dynamic Property in the game.

Refresh decks' properties with latest settings from module:*::

This option enables the <<#deckRefresher,Deck Refresher>> to update Decks in the game. See the section below for more details


|===

Note that you should then save your module to complete the update.

[#deckRefresher]
==== Deck Refresher

As of VASSAL 3.6 you can also refresh the <<Deck.adoc#top, Decks>> in a module. Like Game Pieces, Decks are not normally updated from the module definitions _during_ a game, and so if you have an updated version of the module and load a saved game the deck will still behave according to the original settings. This maintains backward-compatibility with saves and logs made with earlier versions of a module, but it can become awkward when managing modules that use <<GameModule.adoc#PredefinedSetup,Pre-defined Setups>> as starting positions. The Deck Refresher lets you update, add, and delete decks in a game, for this reason.

If you select the _Refresh decks_ option when running the Game Refresher, existing decks will be refreshed from the latest settings and positions in the module definition. This will update almost all of the properties of the deck, including key commands, menu text, and the various check-box options that configure a deck. A deck can even be moved from one position to another this way. However, decks are matched by name, so changing the _name_ of a deck will make the deck refresher think that a deck of the old name has been deleted and a new deck has been created.

===== Adding and Deleting Decks
When _Refresh decks_ is selected, two additional options also become available, to add and delete decks.

If you select the _Delete decks_ option, then any deck found in the game being refreshed that does not match (by name and board) a deck in the module definition will be deleted. Any current contents (e.g., cards) in that deck will be left in a stack at the deck's former location.

If you select the _Add decks_ option, then any _new_ deck found in the module definition that does not exist in the game being refreshed will be _added_. Note this will not add any _contents_ (e.g., cards) to the deck, it will only add the deck. If you need to add contents you will need to arrange to add them separately, e.g., from a piece palette, or dragged in from some other location.


